From a97de3d1852ab8fc332395772f207bdb8ffcffe8 Mon Sep 17 00:00:00 2001
From: "yifan.zhou" <yifan.zhou@thundersoft.com>
Date: Fri, 25 Oct 2024 17:24:00 +0800
Subject: [PATCH 2/3] Camera_Teledyne2: Skip sof freeze.

IssueID: TC-R-DF-00001

Change-Id: Iedb713b390c851acc2781ce05e84bfe8de530f06
Signed-off-by: yifan.zhou <yifan.zhou@thundersoft.com>
---
 drivers/cam_isp/cam_isp_context.c      | 15 ++++++++-------
 drivers/cam_req_mgr/cam_req_mgr_core.c |  5 +++--
 2 files changed, 11 insertions(+), 9 deletions(-)

diff --git a/drivers/cam_isp/cam_isp_context.c b/drivers/cam_isp/cam_isp_context.c
index 6e30af0..e4492d6 100644
--- a/drivers/cam_isp/cam_isp_context.c
+++ b/drivers/cam_isp/cam_isp_context.c
@@ -2791,13 +2791,14 @@ end:
 			req_msg.u.err_msg.request_id = error_request_id;
 			req_msg.u.err_msg.resource_size = 0x0;
 
-			if (cam_req_mgr_notify_message(&req_msg,
-					V4L_EVENT_CAM_REQ_MGR_ERROR,
-					V4L_EVENT_CAM_REQ_MGR_EVENT))
-				CAM_ERR(CAM_ISP,
-					"Error in notifying the error time for req id:%lld ctx %u",
-						ctx_isp->last_applied_req_id,
-						ctx->ctx_id);
+			// if (cam_req_mgr_notify_message(&req_msg,
+			// 		V4L_EVENT_CAM_REQ_MGR_ERROR,
+			// 		V4L_EVENT_CAM_REQ_MGR_EVENT))
+			// 	CAM_ERR(CAM_ISP,
+			// 		"Error in notifying the error time for req id:%lld ctx %u",
+			// 			ctx_isp->last_applied_req_id,
+			// 			ctx->ctx_id);
+			CAM_ERR(CAM_ISP, "addtest skip sof freeze");
 		}
 		ctx_isp->substate_activated = CAM_ISP_CTX_ACTIVATED_HW_ERROR;
 	} else {
diff --git a/drivers/cam_req_mgr/cam_req_mgr_core.c b/drivers/cam_req_mgr/cam_req_mgr_core.c
index 59d5763..8c88265 100644
--- a/drivers/cam_req_mgr/cam_req_mgr_core.c
+++ b/drivers/cam_req_mgr/cam_req_mgr_core.c
@@ -2217,8 +2217,9 @@ static int __cam_req_mgr_process_sof_freeze(void *priv, void *data)
 	msg.u.err_msg.request_id = 0;
 	msg.u.err_msg.link_hdl   = link->link_hdl;
 
-	rc = cam_req_mgr_notify_message(&msg,
-		V4L_EVENT_CAM_REQ_MGR_ERROR, V4L_EVENT_CAM_REQ_MGR_EVENT);
+	// rc = cam_req_mgr_notify_message(&msg,
+	// 	V4L_EVENT_CAM_REQ_MGR_ERROR, V4L_EVENT_CAM_REQ_MGR_EVENT);
+	CAM_ERR(CAM_CRM, "addtest skip notiry sof freeze");
 
 	if (rc)
 		CAM_ERR(CAM_CRM,
-- 
2.7.4

